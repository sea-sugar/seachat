<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Socket.IO Example</title>
  <script src="https://cdn.socket.io/4.3.1/socket.io.js"></script>
  <script>
    // // 连接到服务器
    // const socket = io('ws://localhost:3000',{
    // //   path: '/ws',
    //   query: {
    //     userId: '123', // 传递用户ID
    //     room: 'chat' // 传递房间名称
    //   }
    // });

    // // 当连接建立后的事件处理函数
    // socket.on('connect', () => {
    //   console.log('Connected to server');
    // });

    // // 当收到服务器消息时的事件处理函数
    // socket.on('message', (data) => {
    //   console.log('Message from server:', data);
    // });
    
    const socketUrl = 'ws://localhost:3001';//  /ws?token=${getToken()}
    console.log("socketUrl:", socketUrl);
    const ws = new io(socketUrl);
    ws.onmessage = function (e) {
          console.log(`${new Date().toLocaleString()} >>>>> 收到消息 ${e.data}`, state.ws);
        };
  
        ws.onclose = function () {
          console.log(`${new Date().toLocaleString()} >>>>> 连接已关闭`);
          // 尝试重新连接
        //   dispatch('reconnectWebSocket');
        };
  
        ws.onopen = function () {
          console.log(`${new Date().toLocaleString()} >>>>> 连接成功`, ws);
          // 保存 WebSocket 连接信息
          // // 在这里调用 sendWebSocketMessage，确保 state.ws 已经被正确设置

        };
  
        ws.onerror = function (e) {
          console.log(`${new Date().toLocaleString()} >>>>> 数据传输发生异常`, e);
        };
  </script>
</head>
<body>
  <h1>Socket.IO Example</h1>
</body>
</html>
